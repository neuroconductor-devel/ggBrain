<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • ggBrain</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="">
<meta property="og:description" content="ggBrain">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggBrain</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="intro_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip></h1>
            
      
      
      <div class="hidden name"><code>intro.rmd</code></div>

    </div>

    
    
<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{Introduction to the ggBrain Package}
-->
<div id="introduction-to-the-ggbrain-package" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction-to-the-ggbrain-package" class="anchor" aria-hidden="true"></a>Introduction to the ggBrain Package</h1>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor" aria-hidden="true"></a>Introduction</h2>
<p>The <em>ggBrain</em> package converts 3-D or 4-D brain image arrays to “long” data frames, which are then converted in <em>ggplot</em> objects. Users can create multi-panel figures showing several slices from several brains. Within each panel, either structural images can be displayed, or voxelwise statistics (i.e. seed correlations or p-values) can be displayed on top of a template.</p>
<p>The <code>ggBrain</code> function is the flagship function of this package, and requires minimal input from the user. This function generates <em>ggplot</em> objects for displaying brain images. For further customization of brain image figures, the <code>getBrainFrame</code> function can be used to generate long data frames from 3-D or 4-D brain image arrays. These data frames include variables that can be used for faceting images in multi-panel displays. Within the <em>ggBrain</em> package, the <code>ggBrain</code> function makes several calls to <code>getFrameBrain</code>.</p>
<p>The package also includes several aesthetic features, such as: * A special option for “<a href="#tri-planar">tri-planar</a>” figures: For a given voxel, a tri-planar figure shows the sagittal, coronal, and transverse slices that intersect that voxel. These three slices are shown in three panels, and cross-hairs are generated to show the spacial correspondence between the slices. * Separete fill scales for template images and for overlaying voxelwise statistics: The <em>ggplot2</em> package generally discourages the use of color to display different types of data, on different scales. This poses a challange for brain image figures where we want to use color to display tissue intensity of a template brain image, and also use color to show the value of a voxel-wise statistic (such as seed correlation) overlaid on top of the template. The template tissue intensities and the test statistic values are on different scales, which goes against <em>ggplot</em>’s method of mapping only one scale to color. <code>ggBrain</code> implements the quick fix of hardcoding the coloring of the template image. * Combined legends that incorportate both alpha blending and fill. * <em>ggplot</em> themes, for changing the background to be black, and for removing irrelevant plot labels.</p>
<p>The remainder of this vignette provides example code for <a href="#single-panel">basic image figures</a> with just one slice, for <a href="#multi-panel">multi-panel</a> figures, and for <a href="#tri-planar">tri-planar</a> figures.</p>
</div>
<div id="single-panel-figures" class="section level2">
<h2 class="hasAnchor">
<a href="#single-panel-figures" class="anchor" aria-hidden="true"></a><a name="single-panel"> Single-panel figures</a>
</h2>
<p>Before beginning our basic examples, we’ll load brain images for use in the remainder of this vignette.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Loading data for use in all examples</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://rig.oro.us.com" class="external-link">oro.nifti</a></span><span class="op">)</span> <span class="co">#for opening nii.gz files</span></code></pre></div>
<pre><code>## oro.nifti 0.10.3</code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">s_map1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/oro.nifti/man/read_nifti.html" class="external-link">readNIfTI</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'seed_corr_1.nii.gz'</span>, package<span class="op">=</span><span class="st">'ggBrain'</span><span class="op">)</span><span class="op">)</span>
<span class="va">s_map2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/oro.nifti/man/read_nifti.html" class="external-link">readNIfTI</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'seed_corr_2.nii.gz'</span>, package<span class="op">=</span><span class="st">'ggBrain'</span><span class="op">)</span><span class="op">)</span>
<span class="va">template</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/oro.nifti/man/read_nifti.html" class="external-link">readNIfTI</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'template.nii.gz'</span>, package<span class="op">=</span><span class="st">'ggBrain'</span><span class="op">)</span><span class="op">)</span>
<span class="va">mask</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/oro.nifti/man/read_nifti.html" class="external-link">readNIfTI</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'brain_mask.nii.gz'</span>, package<span class="op">=</span><span class="st">'ggBrain'</span><span class="op">)</span><span class="op">)</span>
<span class="va">seed_mask</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/oro.nifti/man/read_nifti.html" class="external-link">readNIfTI</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'seed_mask.nii.gz'</span>, package<span class="op">=</span><span class="st">'ggBrain'</span><span class="op">)</span><span class="op">)</span>
<span class="va">nii1_trunc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/oro.nifti/man/read_nifti.html" class="external-link">readNIfTI</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'subj_trunc_1.nii.gz'</span>, package<span class="op">=</span><span class="st">'ggBrain'</span><span class="op">)</span><span class="op">)</span>


<span class="co"># get high definition brain image from the brainR package</span>
<span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">brainR</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="va">hd_template</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/oro.nifti/man/read_nifti.html" class="external-link">readNIfTI</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"MNI152_T1_1mm_brain.nii.gz"</span>, package<span class="op">=</span><span class="st">"brainR"</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<pre><code>## Loading required package: brainR</code></pre>
<pre><code>## Loading required package: rgl</code></pre>
<pre><code>## This build of rgl does not include OpenGL functions.  Use
##  rglwidget() to display results, e.g. via options(rgl.printRglwidget = TRUE).</code></pre>
<pre><code>## Loading required package: misc3d</code></pre>
<pre><code>## Warning: no DISPLAY variable so Tk is not available</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ggBrain</span><span class="op">)</span> 
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> </code></pre></div>
<p>To create a single-slice plot of a structural brain image (i.e. MRI, as opposed to fMRI), set the <code>type</code> argument of <code>ggBrain</code> to <code>'structural'</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dd</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/ggBrain.html">ggBrain</a></span><span class="op">(</span>brains<span class="op">=</span><span class="va">hd_template</span>,mask<span class="op">=</span><span class="va">hd_template</span><span class="op">&gt;</span><span class="fl">0</span>,mar<span class="op">=</span><span class="fl">3</span>,mar_ind<span class="op">=</span><span class="fl">93</span>,type<span class="op">=</span><span class="st">'structural'</span><span class="op">)</span>
<span class="co">#now add aethetic changes with conventional ggplot code.</span>
<span class="va">dd</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_fill_continuous</a></span><span class="op">(</span>low<span class="op">=</span><span class="st">"black"</span>, high<span class="op">=</span><span class="st">"white"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_black_bg.html">theme_black_bg</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="intro_files/figure-html/single-plots-structural-1.png" width="384"></p>
<p>Above, the <code>mar=3</code> argument tells that the transverse plane should be used, as opposed to the sagittal or coronal planes. The <code>mar_ind</code> argument tells the slice number to plot.</p>
<p>Voxelwise statistics can also be plotted on top of a template image. If the voxelwise statistic can be both positive and negative (i.e. seed correlation images), users should set <code>type=signed</code>. <code>ggBrain</code> uses color to denote the sign of the voxelwise statistic, and alpha blending to denote the absolute value of the statistic. By default, <code>ggBrain</code> combines these two aesthetic dimensions (color and alpha blending) into a single legend. This is achieved by binning the values of the voxelwise statistic. The legend shows the upper boundaries of these bins.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># s_map1 is a seed correlation image, based on correlation with the region denoted by seed_mask</span>
<span class="va">dd</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/ggBrain.html">ggBrain</a></span><span class="op">(</span>template<span class="op">=</span><span class="va">template</span>,brains<span class="op">=</span><span class="va">s_map1</span>,mask<span class="op">=</span><span class="va">mask</span>,mar<span class="op">=</span><span class="fl">3</span>,mar_ind<span class="op">=</span><span class="fl">30</span>,type<span class="op">=</span><span class="st">'signed'</span><span class="op">)</span>

<span class="va">dd</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_black_bg.html">theme_black_bg</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="intro_files/figure-html/single-plots-seed-corr-1.png" width="384"></p>
<p>For voxelwise statistics are all positive (i.e., p-values), the <code>type</code> argument should be set to <code>'positive'</code>. As an example here we simply take the absolute value of the seed correlation image, but a p-value map could also be displayed.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dd</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/ggBrain.html">ggBrain</a></span><span class="op">(</span>template<span class="op">=</span><span class="va">template</span>,brains<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">s_map1</span><span class="op">)</span>,mask<span class="op">=</span><span class="va">mask</span>,mar<span class="op">=</span><span class="fl">3</span>,mar_ind<span class="op">=</span><span class="fl">30</span>,type<span class="op">=</span><span class="st">'positive'</span><span class="op">)</span>

<span class="va">dd</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_alpha.html" class="external-link">scale_alpha</a></span><span class="op">(</span>range<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_black_bg.html">theme_black_bg</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="intro_files/figure-html/single-plots-abs-val-1.png" width="384"></p>
<p>If no template is specified, values are plotted against a pure white version of the mask.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dd</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/ggBrain.html">ggBrain</a></span><span class="op">(</span>brains<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">s_map1</span><span class="op">)</span>,mask<span class="op">=</span><span class="va">mask</span>,mar<span class="op">=</span><span class="fl">3</span>,mar_ind<span class="op">=</span><span class="fl">30</span>,type<span class="op">=</span><span class="st">'positive'</span><span class="op">)</span>

<span class="va">dd</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_alpha.html" class="external-link">scale_alpha</a></span><span class="op">(</span>range<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_black_bg.html">theme_black_bg</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="intro_files/figure-html/single-plots-no-template-1.png" width="384"></p>
<p>For users more familiar with <em>ggplot</em>, the <code>getBrainFrame</code> function can be used to generate a data frames for use in <em>ggplot</em> objects. This can allows more control over plotting choices, but also requires more input from the user.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bf</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/ggBrain.html">getBrainFrame</a></span><span class="op">(</span>brains<span class="op">=</span><span class="va">hd_template</span>,mar<span class="op">=</span><span class="fl">3</span>,mar_ind<span class="op">=</span><span class="fl">93</span>,mask<span class="op">=</span><span class="va">hd_template</span><span class="op">&gt;</span><span class="fl">0</span>,center_coords<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bf</span><span class="op">)</span></code></pre></div>
<pre><code>##   value row col row_ind col_ind
## 1  3409  97  26       1       1
## 2  3877  98  26       1       1
## 3  4258  99  26       1       1
## 4  4530 100  26       1       1
## 5  4710 101  26       1       1
## 6  4782 102  26       1       1</code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">bf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">row</span>,y<span class="op">=</span><span class="va">col</span>,fill<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">row_ind</span><span class="op">~</span><span class="va">col_ind</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="intro_files/figure-html/single-plots-bf-1.png" width="384"></p>
</div>
<div id="multi-panel-brain-figures" class="section level2">
<h2 class="hasAnchor">
<a href="#multi-panel-brain-figures" class="anchor" aria-hidden="true"></a><a name="multi-panel"> Multi-panel brain figures</a>
</h2>
<p>For multi-panel images, either <code>ggBrain</code> or <code>getBrainFrame</code> require the input of several vectors: <code>mar</code>, <code>mar_ind</code>, <code>col_ind</code>, <code>row_ind</code>. All of these vectors should be of the same length. This length will be equal to the number of panels in the final figure.</p>
<p>For each panel, <code>mar</code> denotes which margin of the brain image we should slice over, <code>mar_ind</code> denotes the slice number, and <code>row_ind</code> and <code>col_ind</code> denote the position of the panel within the overall figure. This layout convention allows for several types of images to be constructed, such as <a href="#tri-planar">tri-planar</a> figures and comparisons of images from different subjects.</p>
<p>As a basic example, suppose we wish to show four transverse slices from a single subject’s brain image.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mar_ind</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">140</span>,<span class="fl">90</span>,length<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>

<span class="va">dd</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/ggBrain.html">ggBrain</a></span><span class="op">(</span><span class="va">hd_template</span>, mask<span class="op">=</span><span class="va">hd_template</span><span class="op">&gt;</span><span class="fl">0</span>,
  mar<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>,
    mar_ind<span class="op">=</span><span class="va">mar_ind</span>,
    col_ind<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,
    row_ind<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Slice'</span>,<span class="va">mar_ind</span><span class="op">)</span><span class="op">)</span>,
    type<span class="op">=</span><span class="st">'structural'</span><span class="op">)</span>

<span class="va">dd</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_black_bg.html">theme_black_bg</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<p><img src="intro_files/figure-html/4panel-1.png" width="480"></p>
<p>Above, setting the values of <code>row_ind</code> to the vector <code>c(1,2,3,4)</code> causes the images to be aligned vertically.</p>
<p>Alternatively, we can use the <code>time</code> argument to plot different images taken during the course of an fMRI</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dd</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/ggBrain.html">ggBrain</a></span><span class="op">(</span>brains<span class="op">=</span><span class="va">nii1_trunc</span>,template<span class="op">=</span><span class="va">template</span>,
  mask<span class="op">=</span><span class="va">mask</span>,
    mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,
    mar_ind<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">4</span><span class="op">)</span>,
    row_ind<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>,
    col_ind<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Time'</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,
    time<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>

<span class="va">dd</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_black_bg.html">theme_black_bg</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">'Sample fMRI data'</span><span class="op">)</span></code></pre></div>
<p><img src="intro_files/figure-html/fMRI-1.png" width="768"></p>
<p>We can also use the <code>brain_ind</code> argument to show seed correlation images from two different subjects. Changing the <code>mar</code> vector lets us to show different slices for each subject. Note, these correlation images are on the same scale.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dd</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/ggBrain.html">ggBrain</a></span><span class="op">(</span>brains<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">s_map1</span>,<span class="va">s_map2</span><span class="op">)</span>,
  brain_ind<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,
    template<span class="op">=</span><span class="va">template</span>,
    mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,
    mar_ind<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">37</span>,<span class="fl">18</span>,<span class="fl">30</span>,<span class="fl">37</span>,<span class="fl">18</span>,<span class="fl">30</span><span class="op">)</span>,
    row_ind<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Subject 1'</span>,<span class="st">'Subject 1'</span>,<span class="st">'Subject 1'</span>,<span class="st">'Subject 2'</span>,<span class="st">'Subject 2'</span>,<span class="st">'Subject 2'</span><span class="op">)</span>,
    col_ind<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Sagittal'</span>,<span class="st">'Coronal'</span>,<span class="st">'Transverse'</span><span class="op">)</span><span class="op">)</span>,
    mask<span class="op">=</span><span class="va">mask</span><span class="op">)</span>
<span class="va">dd</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">'Seed correlations for two subjects'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_black_bg.html">theme_black_bg</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="intro_files/figure-html/2brain_compare-1.png" width="768"></p>
<p>The <code>lines_mat</code> argument can be used to add a key to multi-panel plots. This argument should contain a matrix with 3 columns, and one row for each line to be added to the figure. Each row of <code>lines_mat</code> should contain a triplet of values, with the first element telling which panel the line should be placed in, the second element containing the margin to plot over, and the third element telling the slice index where the line should be placed.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mar</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">mar_ind</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">140</span>,<span class="fl">50</span>,length<span class="op">=</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span>,<span class="fl">88</span><span class="op">)</span>
<span class="va">col_ind</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>
<span class="va">row_ind</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>
<span class="va">lines_mat</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="st">'panel'</span><span class="op">=</span><span class="fl">8</span>,<span class="va">mar</span>,<span class="va">mar_ind</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>,<span class="op">]</span>

<span class="va">lines_mat</span></code></pre></div>
<pre><code>##      panel mar mar_ind
## [1,]     8   3     140
## [2,]     8   3     125
## [3,]     8   3     110
## [4,]     8   3      95
## [5,]     8   3      80
## [6,]     8   3      65
## [7,]     8   3      50</code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggBrain.html">ggBrain</a></span><span class="op">(</span>brains<span class="op">=</span><span class="va">hd_template</span>, mar<span class="op">=</span><span class="va">mar</span>, mar_ind<span class="op">=</span><span class="va">mar_ind</span>,
              row_ind<span class="op">=</span><span class="va">row_ind</span>, col_ind<span class="op">=</span><span class="va">col_ind</span>, mask<span class="op">=</span><span class="va">hd_template</span><span class="op">&gt;</span><span class="fl">0</span>,
              type<span class="op">=</span><span class="st">'structural'</span>, lines_mat<span class="op">=</span><span class="va">lines_mat</span><span class="op">)</span>

<span class="va">dd</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_black_bg.html">theme_black_bg</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_black_bg.html">theme_all_blank</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="intro_files/figure-html/line-key-str-1.png" width="672"></p>
<p>These types of plots can also be created for voxelwise statistics</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mar_ind</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">48</span>,<span class="fl">20</span>,length<span class="op">=</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span>,<span class="fl">30</span><span class="op">)</span> <span class="co">#reduce dimensions</span>
<span class="co"># to match fMRI data</span>
<span class="va">lines_mat</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="st">'panel'</span><span class="op">=</span><span class="fl">8</span>,<span class="va">mar</span>,<span class="va">mar_ind</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>,<span class="op">]</span>

<span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggBrain.html">ggBrain</a></span><span class="op">(</span>brains<span class="op">=</span><span class="va">s_map1</span>, template<span class="op">=</span><span class="va">template</span>, mar<span class="op">=</span><span class="va">mar</span>,mar_ind<span class="op">=</span><span class="va">mar_ind</span>,
              row_ind<span class="op">=</span><span class="va">row_ind</span>, col_ind<span class="op">=</span><span class="va">col_ind</span>, mask<span class="op">=</span><span class="va">mask</span>, lines_mat<span class="op">=</span><span class="va">lines_mat</span><span class="op">)</span>

<span class="va">dd</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_black_bg.html">theme_black_bg</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_black_bg.html">theme_all_blank</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="intro_files/figure-html/line-key-corr-1.png" width="672"></p>
<div id="tri-planar-figures" class="section level3">
<h3 class="hasAnchor">
<a href="#tri-planar-figures" class="anchor" aria-hidden="true"></a><a name="tri-planar"> Tri-planar figures </a>
</h3>
<p>For a given voxel, a tri-planar figure shows the sagittal, coronal, and transverse slices that intersect that voxel. These three slices are shown in three panels, and cross-hairs are generated to show the spacial correspondence between the panels.</p>
<p>In the example arrangement below, horizontal and vertical cross-hair lines are set up to continue across the panels. Both horizontal cross-hair lines on the top two panels correspond to the same transverse slice, shown in the bottom panel. Both virtical cross-hairs on the leftmost panels correspond to the same sagittal slice, shown on the right.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dd</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/ggBrain.html">ggBrain</a></span><span class="op">(</span>brains<span class="op">=</span><span class="va">s_map1</span>,template<span class="op">=</span><span class="va">template</span>,
  mar <span class="op">=</span>     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,
    mar_ind <span class="op">=</span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">37</span>,<span class="fl">18</span>,<span class="fl">30</span><span class="op">)</span>,
    row_ind<span class="op">=</span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,
    col_ind<span class="op">=</span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,
    tri_planar<span class="op">=</span><span class="cn">TRUE</span>, lines_color<span class="op">=</span><span class="st">'black'</span>,mask<span class="op">=</span><span class="va">mask</span><span class="op">)</span>
<span class="va">dd</span></code></pre></div>
<p><img src="intro_files/figure-html/tri-panel1-1.png" width="960"></p>
<p>In the next example, we show the seed mask and the seed correlation map from an example subject. Since the mask and the map are on different scales, we use <code>grid.arrange</code> to display them separately.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mar</span>   <span class="op">=</span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>
<span class="va">col_ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Sagittal'</span>,<span class="st">'Coronal'</span>,<span class="st">'Transverse'</span><span class="op">)</span><span class="op">)</span>
<span class="va">row_ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">mar_ind</span><span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">37</span>,<span class="fl">18</span>,<span class="fl">30</span><span class="op">)</span>

<span class="va">dd_mask</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/ggBrain.html">ggBrain</a></span><span class="op">(</span>brains<span class="op">=</span><span class="va">seed_mask</span>,template<span class="op">=</span><span class="va">template</span>,mar<span class="op">=</span><span class="va">mar</span>,mar_ind<span class="op">=</span><span class="va">mar_ind</span>,row_ind<span class="op">=</span><span class="va">row_ind</span>,col_ind<span class="op">=</span><span class="va">col_ind</span>,type<span class="op">=</span><span class="st">'binary'</span>,binary_color<span class="op">=</span><span class="st">'black'</span>,tri_planar<span class="op">=</span><span class="cn">TRUE</span>,mask<span class="op">=</span><span class="va">mask</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="st">'Binary mask'</span>,title<span class="op">=</span><span class="st">'Seed Mask'</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="../reference/theme_black_bg.html">theme_black_bg</a></span><span class="op">(</span><span class="op">)</span>


<span class="va">dd_1</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/ggBrain.html">ggBrain</a></span><span class="op">(</span>brains<span class="op">=</span><span class="va">s_map1</span>,template<span class="op">=</span><span class="va">template</span>,mar<span class="op">=</span><span class="va">mar</span>,mar_ind<span class="op">=</span><span class="va">mar_ind</span>,row_ind<span class="op">=</span><span class="va">row_ind</span>,col_ind<span class="op">=</span><span class="va">col_ind</span>,tri_planar<span class="op">=</span><span class="cn">TRUE</span>,mask<span class="op">=</span><span class="va">mask</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">'Seed Correlation Map'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="../reference/theme_black_bg.html">theme_black_bg</a></span><span class="op">(</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">dd_mask</span>,<span class="va">dd_1</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: Using alpha for a discrete variable is not advised.</code></pre>
<p><img src="intro_files/figure-html/tri-panel2-1.png" width="768"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aaron Fisher.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
